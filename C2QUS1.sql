
SELECT * FROM SAILORS;
SELECT * FROM BOATS;

CREATE TABLE SAILORS
(
SID INT,
SNAME VARCHAR(30),
RATING INT,
AGE INT
);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(22,'DUSTIN',7,45);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(29,'BRUTAS',1,33);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(31,'LUBBER',8,55);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(32,'ANDY',8,25);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(58,'RUSTY',10,35);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(64,'HORATIO',7,35);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(71,'ZORBA',10,16);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(74,'HORATIO',9,35);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(85,'ART',3,26);
INSERT INTO SAILORS(SID,SNAME,RATING,AGE) VALUES(95,'BOB',3,64);


CREATE TABLE BOATS
(
BID INT,
BNAME VARCHAR(30),
COLOR VARCHAR(30)
);
INSERT INTO BOATS (BID,BNAME,COLOR) VALUES (101,'INTERLAKE','BLUE');
INSERT INTO BOATS (BID,BNAME,COLOR) VALUES (102,'INTERLAKE','RED');
INSERT INTO BOATS (BID,BNAME,COLOR) VALUES (103,'CLIPPER','GREEN');
INSERT INTO BOATS (BID,BNAME,COLOR) VALUES (104,'MARINE','RED');

SELECT * FROM RESERVES;
CREATE TABLE RESERVES
(
SID INT,
BID INT,
DAY DATE
);
INSERT INTO RESERVES (SID,BID,DAY) VALUES (22,101,'98/10/10');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (22,102,'98/10/10');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (22,103,'98/8/10');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (22,104,'98/7/10');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (31,102,'98/10/11');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (31,103,'98/6/11');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (31,104,'98/12/11');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (64,101,'98/5/9');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (64,102,'98/8/9');
INSERT INTO RESERVES (SID,BID,DAY) VALUES (74,103,'98/8/9');

SELECT AGE,SNAME FROM SAILORS;
SELECT * FROM SAILORS,RESERVES WHERE SAILORS.SID=RESERVES.SID AND BID=101;
SELECT SNAME FROM SAILORS WHERE RATING > 7;
SELECT SNAME  FROM SAILORS,RESERVES WHERE BID=103 AND SAILORS.SID=RESERVES.SID;
SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS WHERE COLOR='RED' AND BOATS.BID=RESERVES.BID AND SAILORS.SID=RESERVES.SID ORDER BY AGE;
SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS WHERE (COLOR='RED' OR  COLOR='GREEN') AND BOATS.BID=RESERVES.BID AND SAILORS.SID=RESERVES.SID;
SELECT DISTINCT  COLOR FROM SAILORS,RESERVES,BOATS WHERE SNAME='LUBBER' AND SAILORS.SID=RESERVES.SID;
SELECT DISTINCT SNAME FROM SAILORS, RESERVES, BOATS WHERE COLOR='RED' AND BOATS.BID=RESERVES.BID AND SAILORS.SID=RESERVES.SID UNION SELECT SNAME FROM SAILORS,RESERVES,BOATS WHERE COLOR='GREEN' AND BOATS.BID=RESERVES.BID AND SAILORS.SID=RESERVES.SID;
SELECT DISTINCT SNAME FROM SAILORS,RESERVES WHERE RESERVES.SID=SAILORS.SID;
SELECT SNAME,RESERVES.SID FROM RESERVES,SAILORS WHERE SAILORS.SID=RESERVES.SID GROUP BY DAY,RESERVES.SID,SNAME HAVING COUNT(DAY)>1;
SELECT SNAME,AGE FROM SAILORS WHERE AGE=(SELECT MIN(AGE) FROM SAILORS);
SELECT SNAME,RATING FROM SAILORS WHERE RATING>(SELECT MAX(RATING) FROM SAILORS WHERE SNAME='HORATIO');
SELECT SNAME FROM (SELECT SNAME,RESERVES.SID,COUNT(BID) AS ID  FROM RESERVES,SAILORS WHERE RESERVES.SID=SAILORS.SID GROUP BY  RESERVES.SID,SNAME) A WHERE ID=(SELECT COUNT(BID) FROM BOATS);
SELECT COUNT(C.SNAME) FROM(SELECT DISTINCT SNAME FROM SAILORS) C;
SELECT AVG(AGE) FROM SAILORS;
SELECT RATING, AVG(AGE) FROM SAILORS GROUP BY RATING;
SELECT A.RATING,B.MEAN FROM (SELECT COUNT(SNAME) AS NUM,RATING FROM SAILORS GROUP BY RATING HAVING COUNT(SNAME)>1)A,(SELECT RATING, AVG(AGE) AS MEAN FROM SAILORS GROUP BY RATING) B WHERE A.RATING=B.RATING;